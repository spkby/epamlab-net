<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title></title>
</head>

<body>
    <h1>Task 2 - start</h1>
    <script>

        var getByn = function (price) {
            var str = String(price);

            switch (str.length) {
                case 1:
                    return "0.0" + str;
                case 2:
                    return "0." + str;
                default:
                    return str.substring(0, str.length - 2) + "." + str.substring(str.length - 2);
            }
        }

        var Purchase = function (name, price, number) {
            this.name = name;
            this.price = price;
            this.number = number;
            this.getCost = function () {
                return this.price * this.number
            }
            this.toString = function () {
                return this.name + ";" + getByn(this.price) + ";" + this.number + ";" + getByn(this.getCost())
            }
        }

        var PercentDiscountPurchase = function (name, price, number, percent) {
            Purchase.apply(this, arguments);
            this.percent = percent;

            var parentGetCost = this.getCost;
            this.getCost = function () {
                return parseInt(parentGetCost.call(this) * (1.0 - this.percent / 100.0));
            }

            var parentToString = this.toString;
            this.toString = function () {
                return parentToString.call(this) + ";" + this.percent;
            }
        }

        var purchases = [
            new Purchase("apple", 121, 5),
            new Purchase("milk", 101, 3),
            new Purchase("bread", 320, 4),
            new Purchase("potato", 122, 1),
            new PercentDiscountPurchase("nuts", 123, 3, 4),
            new PercentDiscountPurchase("oil", 568, 2, 5)
        ];

        document.writeln("<h2>Purchases</h2>");
        for (var i = 0; i < purchases.length; i++) {
            document.writeln("<p>" + purchases[i].toString());
        }

        var totalCost = 0;
        var makeS = function (Purchase) {
            totalCost += Purchase.getCost();
        }

        for (let index = 0; index < purchases.length; index++) {
            makeS(purchases[index]);
        }

        var makeS = function () {
            return getByn(totalCost);
        }
        document.writeln("<h2>Total cost</h2>");
        document.writeln("<h2>" + makeS() + "</h2>");

    </script>
    <h1>Task 2 - end</h1>
</body>

</html>